//----Modification----
/**
 * @date 21/11/2025
 */
void comptagedepoints (int vote, int choix) //choix représentant nombre de glace
{
    //tableau initialisé en dehors pour éviter que ce soit remis à 0 à chaque fois
    for (int i =1; i<(choix+1); i++) //i=1 correspond au numéro de glace et inférieur au nombre de choix +1 pour pas en manquer une.
    {
        if (vote == i) //est-ce que le vote correspond au numéro de la glace
        {
            compteurpoints[i-1] = compteurpoints[i-1] + 1; //i-1 parce que le tableau commence à 0
            break;
        }
        i++;
    }
}

int main()
{
    //cout << "Hello World!" << endl;
    //vector<participant> vParticipant (19);
    /* on va detecter les glaces preférées des votants
    * tout en virant les commentaires
    */

    /* on vote sur 4 glaces */
    vector <string> vGlacePref;
    for (unsigned i (0); i < 4; ++i)
        vGlacePref.push_back(litUneString());
    //tableau pour compter les votes pour chaque glace
    vector<int> compteurpoints (4,0);

    /* debug */
    affichVectString (vGlacePref);

    //On lit les datas du clavier, et on les stocke
        vector<participant> vParticipant;
    //boucle premier tour
    for (unsigned i (0); i < 117; ++i){
        string nom (litUneString());
        string prenom  (litUneString());
        int numGlace (litUnEntier());
        //on compte pour quelle glace est le vote
        comptagedepoints(numGlace);
        //cout << nom << endl << prenom << endl << numGlace << endl;
        //vParticipant.push_back(participant{nom, prenom, numGlace});
              //  vJoueur[numEquipe-1].push_back(joueur {nom, prenom, numEquipe});
    }

    //on récupère les deux meilleures glaces (le plus de vote)
    int max1 = 0;
    int max2 = 0;
    for (unsigned i=1; i < 4; i=i+1){
        if (vCompteur[i] > vCompteur[max1]){ // Si il y a plus de voix pour la glace courante que le max actuel
            max2 = max1; // On met le max courant en second
            max1 = i;
        }
        else if (vCompteur[i] > vCompteur[max2]){ // Cas ou les votes pour la glace courante seraient plus grands que le second maximum
            max2 = i;
        }

    //et on le remet dans un nouveau tableau avec 2 entrée cette fois. ou on supprime voir TD10
        vector <string> vGlacePref;
     for (unsigned i (0); i < 2; ++i)
        vGlacePref.push_back(litUneString());



    //deuxième tour
    for (unsigned i (0); i < 117; ++i){
        string nom (litUneString());
        string prenom  (litUneString());
        int numGlace (litUnEntier());
        comptagedepointstour2(numGlace);
        //cout << nom << endl << prenom << endl << numGlace << endl;
        //vParticipant.push_back(participant{nom, prenom, numGlace});
            //  vJoueur[numEquipe-1].push_back(joueur {nom, prenom, numEquipe});
    }

    affichVectParticipants(vParticipant);
    cout << string (15, '-') << endl;
    sort (vParticipant.begin(), vParticipant.end(), compare2part);
    affichVectParticipants(vParticipant);

    cout << "c'est la glace " << vGlacePref[0] << " qui a gagne" << endl;
    return 0;
}

//--------------------------CODE MODIFIE-------------------------------------



int main()
{
    //cout << "Hello World!" << endl;
    //vector<participant> vParticipant (19);
    /* on va detecter les glaces preférées des votants
    * tout en virant les commentaires
    */

    /* on vote sur 4 glaces */
    vector<string> vGlacePref;
    for (unsigned i (0); i < 4; ++i)
        vGlacePref.push_back(litUneString());
    affichVectString(vGlacePref);
    //On lit les datas du clavier, et on les stocke
    vector<participant> vParticipant;

    for (unsigned i (0); i < 117; ++i){
        string nom (litUneString());
        string prenom  (litUneString());
        int numGlace (litUnEntier());
        //cout << nom << endl << prenom << endl << numGlace << endl;
        vParticipant.push_back(participant{nom, prenom, numGlace});
              //  vJoueur[numEquipe-1].push_back(joueur {nom, prenom, numEquipe});
    }

    affichVectParticipants(vParticipant);
    cout << string (15, '-') << endl;
    sort (vParticipant.begin(), vParticipant.end(), compare2part);
    affichVectParticipants(vParticipant);

    // Vote majoritaire en deux tours :

    //Votes du premier tour
    vector<int> vCompteur (4,0); //4 glaces
    for (const participant & part : vParticipant){
        vCompteur[part.glacePref-1] += 1;
    }
    //Cas de la majorité absolue
    bool majoriteAbsolue (false);
    for (unsigned i (0); i < vCompteur.size(); ++i){
        if (vCompteur[i] > vParticipant.size()/2){ // Si le nombre de voix est plus grand que le nombre de participants :
            majoriteAbsolue = true; // il y a majorité
            cout << "la glace élue est : " << vGlacePref[i] << endl;
        }
    }

    //Cas sans majorité absolue
    if (!majoriteAbsolue){
        //Les deux glaces en tete
        int max1 = 0;
        int max2 = 0;
        for (unsigned i=1; i < 4; i=i+1){
            if (vCompteur[i] > vCompteur[max1]){ // Si il y a plus de voix pour la glace courante que le max actuel
                max2 = max1; // On met le max courant en second
                max1 = i;
            }
            else if (vCompteur[i] > vCompteur[max2]){ // Cas ou les votes pour la glace courante seraient plus grands que le second maximum
                max2 = i;
            }
        }
        
        //On refait un comptage en comptant la deuxieme partie des voix
        for (unsigned i (0); i < 117; ++i){
            string nom (litUneString());
            string prenom  (litUneString());
            int numGlace (litUnEntier());
            vParticipant.push_back(participant{nom, prenom, numGlace});
        }

        //On replace les gagnantes en premier
        if(vGlacePref[0]==vGlacePref[max2]){
            temp = vGlacePref[0];
            vGlacePref[0] = vGlacePref[max1];
            vGlacePref[1] = temp;
        else if
            vGlacePref[0] = vGlacePref[max1];
            vGlacePref[1] = vGlacePref[max2];

        }

        for (const participant & part = vParticipant){
            if (vCompteur[part.glacePref-1] == max1)
                vCompteur2[0] += 1;
            else if (vCompteur[part.glacePref-1] == max2)
                vCompteur2[1] += 1;
        }

        //On affiche la glace élue ou annonce une égalité
        if (vCompteur2[0] > vCompteur2[1])
            cout << "la glace élue est : " << vGlacePref[0] << endl;
        else if (vCompteur2[1] > vCompteur2[0])
            cout << "la glace élue est : " << vGlacePref[1] << endl;
        else
            cout << "Egalité entre les deux glaces en tête" << endl;

    return 0;
}
